!function(){const t={trackingParams:["gclid","gbraid","wbraid","msclkid","fbclid"],storageKey:"tracking_params",storageExpiryKey:"tracking_params_expiry",storageDuration:2592e6},e=[/googlebot\//i,/bingbot/i,/yandexbot/i,/duckduckbot/i,/baiduspider/i,/facebookexternalhit\//i,/twitterbot/i,/linkedinbot/i,/pinterest/i];class r{constructor(){this.isCrawlerVisitor=this.isCrawler(),this.trackingId="desconhecido",this.storedParams={},this.initialize()}isCrawler(){const r=navigator.userAgent.toLowerCase();return e.some(e=>e.test(r))}initialize(){var e;this.isCrawlerVisitor||((e=this.getStoredParameters())&&(this.storedParams=e.params,this.trackingId=this.getTrackingIdFromParams(e.params)),this.processUrlParameters())}getTrackingIdFromParams(e){for(const r of t.trackingParams)if(e[r])return e[r];return"desconhecido"}encodeSpecialChars(e){return e.replace(/ /g,"_s_").replace(/-/g,"_d_").replace(/\//g,"")}processUrlParameters(){var e=new URLSearchParams(window.location.search);let a=!1;e.forEach((e,r)=>{this.storedParams[r]=e,t.trackingParams.includes(r)&&(this.trackingId=e,a=!0)}),a&&this.storeParameters(this.storedParams)}storeParameters(e){e={params:e,timestamp:(new Date).getTime()};try{localStorage.setItem(t.storageKey,JSON.stringify(e)),localStorage.setItem(t.storageExpiryKey,((new Date).getTime()+t.storageDuration).toString())}catch(e){console.warn("Erro ao salvar parametros:",e)}}getStoredParameters(){try{var e=localStorage.getItem(t.storageKey),r=localStorage.getItem(t.storageExpiryKey);return e&&r?(new Date).getTime()>parseInt(r)?(localStorage.removeItem(t.storageKey),localStorage.removeItem(t.storageExpiryKey),null):JSON.parse(e):null}catch(e){return console.warn("Erro ao recuperar parametros:",e),null}}processPageLinks(){if(!this.isCrawlerVisitor){var r=document.getElementsByTagName("a");for(let e=0;e<r.length;e++){var a=r[e],t=a.hash,s=a.href.split("#")[0];try{var i=new URL(s,document.location.href);const o=i.searchParams;o.forEach((e,r)=>{var a;e.includes("[cnlid]")||e.includes("%5Bcnlid%5D")?(a=e.replace(/\[cnlid\]/g,this.trackingId).replace(/%5Bcnlid%5D/g,this.trackingId),o.set(r,"tid"===r.toLowerCase()?this.encodeSpecialChars(a):a)):"tid"===r.toLowerCase()&&o.set(r,this.encodeSpecialChars(e))}),Object.entries(this.storedParams).forEach(([e,r])=>{o.has(e)||o.set(e,"tid"===e.toLowerCase()?this.encodeSpecialChars(r):r)}),a.href=i.toString()+t}catch(e){console.warn("Erro ao processar link:",a.href,e)}}}}}const a=(new Date).getTime();console.log("üöÄ Inicializando Cannoli..."),window.onload=function(){(new r).processPageLinks(),console.log("‚úÖ Cannoli inicializado com sucesso");var e=(new Date).getTime(),e=e-a;console.log(`‚è±Ô∏è Tempo: ${e}ms`)}}();
